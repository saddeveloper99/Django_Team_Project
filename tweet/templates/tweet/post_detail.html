{% extends 'base.html' %}
{% block title %}
    메인페이지
{% endblock %}

{% block content %}
    <!DOCTYPE html>
    <html>
    <head>
        <style>
            .main {
                margin-left: 200px;
            }

            .top {
                margin-top: 100px;
            }

            .youtube {
                width: 500px;
                height: 300px;
                margin-top: 30px;
                margin-bottom: 30px;
            }

            .content {
                margin-bottom: 50px;
            }

            .bottom {
                margin-left: 250px;
            }

            .info {
                margin-left: 190px;
            }

            .toolbox {
                margin-left: 310px;
                display: flex;
                flex-direction: row;
            }
        </style>

        <script>
            function show_my_comment_set() {
                var x = document.getElementById("comment_set");
                x.style.display = (x.style.display === "none") ? "block" : "none";
                {#  자바스크립트의 삼항 연산자, === :값과 데이터가 동일한지 확인   #}
                {#   block : 속성을 표기 , none : 속성을 표기하지 않음     #}
            }

            function print_star(num) {
                star = "⭐".repeat(num)
                {#star += "☆".repeat(5 - num)#}
                {# repeat 메소드는 다음과 같다. #}
                {# python :  star = "*" * 3  #}
                document.write(star);
            }
        </script>


        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{{ post.title }}</title>
    </head>
    <body>
    <div class="main">
        <div class="top"></div>
        <div>
            <h1>{{ post.title }}</h1>
        </div>
        <iframe src="https://www.youtube.com/embed/{{ post.youtube_url }}" class="youtube">
        </iframe>
        <div class="content">{{ post.comment }}</div>
        <div class="bottom">
            <div class="info">
                작성자 : {{ post.owner.username }} <br/>
                작성시간 : {{ post.update_at }} <br/>
                수정시간 : {{ post.create_at }} <br/>
                =========================<br/>
            </div>

            <div class="toolbox">

                {% if  request.user.user_id == post.owner.user_id %}
                    <form action="{% url 'set-post' post.post_id %}" method="GET">
                        <button type='submit' title="수정"> 수정</button>
                    </form>
                    <form action="{% url 'delete-post' post.post_id %}" method="POST">
                        {% csrf_token %}
                        <button type='submit' title="삭제">삭제</button>
                    </form>
                {% endif %}

                <input type=button value="목록" onclick="location.href='http://127.0.0.1:8000/'">
            </div>
        </div>
    </div>




    {% for index in post_comments %}
        {{ index.owner.username }}
        {{ index.post_comment }}
        {{ index.com_updated_at }}
        <br>
        <span><script>print_star({{ index.comment_star }});</script></span>
        {% if  request.user.user_id == index.owner.user_id %}
            <div style="display: flex;">
                <form method="post" action="{% url 'delete-comment' index.post_comment_id %}">
                    {% csrf_token %}
                    <button type="submit">삭제</button>
                </form>
                <button onclick="show_my_comment_set()">수정</button>
            </div>
        {% endif %}
        <div id="comment_set"
             style="display: none; margin-top: 30px; margin-bottom: 30px; background-color: rgba(174,240,255,0.98); width: 1110px">
            <form method="post" action="{% url 'set-comment' index.post_comment_id %}">
                {% csrf_token %}
                <div>
                    <label for="post-comment"> 작성자 : {{ index.owner.username }}</label> <br>
                    <textarea name="post-comment" placeholder=" 수정할 댓글 : {{ index.post_comment }}" rows="2" cols="150"
                              required></textarea>
                </div>
                <div style="display: inline-block; margin-left: 920px">
                    <select name="comment_star">
                        <option>⭐⭐⭐⭐⭐</option>
                        <option>⭐⭐⭐⭐</option>
                        <option>⭐⭐⭐</option>
                        <option>⭐⭐</option>
                        <option>⭐</option>
                    </select>
                </div>
                <button type="submit">댓글 수정</button>
            </form>
        </div>

    {% endfor %}


    <br>

    {% if user.is_authenticated %}

        <div>
            <form method="post" action="{% url 'create-comment' post.post_id %}">
                {% csrf_token %}
                <div>
                    <label for="post-comment"> 작성자 : {{ user.username }}</label> <br>
                    <textarea name="post-comment" placeholder="댓글을 작성해주세요." rows="2" cols="150" required></textarea>
                </div>
                <div style="display: inline-block; margin-left: 920px">
                    <select name="comment_star">
                        <option>⭐⭐⭐⭐⭐</option>
                        <option>⭐⭐⭐⭐</option>
                        <option>⭐⭐⭐</option>
                        <option>⭐⭐</option>
                        <option>⭐</option>
                    </select>
                </div>
                <button type="submit">댓글 작성</button>
            </form>
        </div>


    {% endif %}


    </body>
    </html>




{% endblock %}
